Excelente iniciativa. Uma definição de IPs (Addressing Plan) sólida é 50% do sucesso deste projeto, especialmente por causa da restrição do **Cisco não entender VXLAN**.

Para contornar essa restrição e permitir o **MPLS-TE para o Cliente L1**, vamos usar uma estratégia avançada: **Loopbacks Secundárias**.

* **Loopback0:** Para gestão, Router-ID e tráfego do Cliente L2 (Normal).
* **Loopback1:** Exclusivo para ser a origem/destino dos túneis VXLAN do **Cliente L1**.

Desta forma, os Routers Cisco conseguem distinguir o tráfego apenas olhando para o IP de destino (`10.0.0.x` vs `10.0.1.x`) e aplicar as regras de Engenharia de Tráfego ou QoS.

O enunciado define que a empresa tem a rede `10.0.0.0/22` (10.0.0.0 - 10.0.3.255) para infraestrutura.

### 1. Plano de Endereçamento de Infraestrutura (Underlay)

Vamos dividir o bloco `10.0.0.0/22` da seguinte forma:

#### A. Loopbacks (Gerência & VTEP) - `10.0.0.0/24`

Usaremos máscaras `/32`.

| Dispositivo | Loopback 0 (RID / L2 VTEP) | Loopback 1 (L1 VTEP - Para TE) | Notas |
| --- | --- | --- | --- |
| **Core 1** | `10.0.0.1` | - | Cisco Core |
| **Core 2** | `10.0.0.2` | - | Cisco Core |
| **Lisbon (PE)** | `10.0.0.3` | - | Cisco Edge |
| **Porto (PE)** | `10.0.0.4` | - | Cisco Edge |
| **S1 (Lisbon Spine)** | `10.0.0.11` | - | Linux FRR |
| **S2 (Porto Spine)** | `10.0.0.12` | - | Linux FRR |
| **L11 (Leaf Lx)** | `10.0.0.21` | `10.0.0.121` | Linux FRR |
| **L12 (Leaf Lx)** | `10.0.0.22` | `10.0.0.122` | Linux FRR |
| **L13 (Leaf Lx)** | `10.0.0.23` | `10.0.0.123` | Linux FRR |
| **L21 (Leaf Px)** | `10.0.0.31` | `10.0.0.131` | Linux FRR |
| **L22 (Leaf Px)** | `10.0.0.32` | `10.0.0.132` | Linux FRR |
| **L23 (Leaf Px)** | `10.0.0.33` | `10.0.0.133` | Linux FRR |

*Nota:* Quando configurares o VXLAN para o Cliente L1 no Leaf L11, a origem do túnel será `10.0.0.121`. Para o Cliente L2, será `10.0.0.21`.

#### B. Ligações Ponto-a-Ponto (Links Físicos) - `10.0.1.0/24`

Usaremos máscaras `/30` para poupar IPs e simplificar o routing.

**Core MPLS (Cisco <-> Cisco)**

* Lisbon - Core 1: `10.0.1.0/30` (.1 Lisbon, .2 Core1)
* Lisbon - Core 2: `10.0.1.4/30` (.5 Lisbon, .6 Core2)
* Porto - Core 1: `10.0.1.8/30` (.9 Porto, .10 Core1)
* Porto - Core 2: `10.0.1.12/30` (.13 Porto, .14 Core2)
* Core 1 - Core 2: `10.0.1.16/30` (Link opcional de redundância, recomendado)

**Data Center (Cisco <-> Spine <-> Leaf)**

* **Lisboa:**
* Lisbon(PE) - S1: `10.0.1.20/30`
* S1 - L11: `10.0.1.24/30`
* S1 - L12: `10.0.1.28/30`
* S1 - L13: `10.0.1.32/30`


* **Porto:**
* Porto(PE) - S2: `10.0.1.36/30`
* S2 - L21: `10.0.1.40/30`
* S2 - L22: `10.0.1.44/30`
* S2 - L23: `10.0.1.48/30`



---

### 2. Redes dos Clientes (Overlay)

Estas redes vivem "dentro" do VXLAN e não interferem com o routing OSPF da infraestrutura acima.

Cliente L1 (VRF: Client-L1) 

* **VLAN 10:** `10.10.0.0/22` (Gateway: `10.10.0.1` nos Leafs)
* **VLAN 20:** `10.20.0.0/22` (Gateway: `10.20.0.1` nos Leafs)
* **VLAN 30:** `10.30.0.0/22` (Gateway: `10.30.0.1` nos Leafs)

Cliente L2 (VRF: Client-L2) 

* **LAN Única:** `10.40.0.0/22` (Gateway: `10.40.0.1` nos Leafs)

---

### 3. Diagrama Visual da Topologia

### O que fazer agora?

Recomendo começarmos pela **Configuração dos Routers Cisco (Core e PEs)** para garantir a conectividade MPLS básica. Sem isto, o Data Center não comunica.

**Queres que gere as configurações iniciais (interfaces + OSPF + MPLS LDP) para os routers `Lisbon`, `Porto`, `Core1` e `Core2`?**
