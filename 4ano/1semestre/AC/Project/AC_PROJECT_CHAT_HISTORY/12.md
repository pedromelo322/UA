Esta é uma excelente decisão. Como o enunciado diz que *"All clients have servers in all locations and racks"*, a melhor estratégia é **misturar** os Clientes nos Racks. Isso demonstra "Multi-tenancy" (vários clientes a partilhar a mesma infraestrutura física), o que é muito valorizado.

Aqui tens o plano de distribuição ideal para os teus 12 VPCs (6 em Lisboa, 6 no Porto), garantindo que tens pares para testar a conectividade de todas as VLANs.

### 1. Plano de Distribuição (Lisboa)

Vamos configurar os Switches `Switch1`, `Switch2`, `Switch3` no GNS3 para separarem o tráfego nas portas.

| Rack (Leaf) | Switch | PC (GNS3) | Cliente | VLAN | Rede IP | IP Sugerido (S/ Gateway) |
| --- | --- | --- | --- | --- | --- | --- |
| **Rack 11 (L11)** | Switch1 | **PC1** | L1 (Web) | **10** | 10.10.0.x | `10.10.0.1/24` |
|  |  | **PC2** | L2 (LAN) | **40** | 10.40.0.x | `10.40.0.1/24` |
| **Rack 12 (L12)** | Switch2 | **PC3** | L1 (App) | **20** | 10.20.0.x | `10.20.0.1/24` |
|  |  | **PC4** | L2 (LAN) | **40** | 10.40.0.x | `10.40.0.3/24` |
| **Rack 13 (L13)** | Switch3 | **PC5** | L1 (DB) | **30** | 10.30.0.x | `10.30.0.1/24` |
|  |  | **PC6** | L1 (Web) | **10** | 10.10.0.x | `10.10.0.3/24` |

*Nota:* No Rack 13 repeti a VLAN 10 para o PC6, pois o Cliente L2 já está bem representado nos outros dois.

---

### 2. Plano de Distribuição (Porto)

Aqui fazemos o espelho de Lisboa, para garantir que o PC1 (Lisboa) tem alguém com quem falar no Porto (PC7).

| Rack (Leaf) | Switch | PC (GNS3) | Cliente | VLAN | Rede IP | IP Sugerido (S/ Gateway) |
| --- | --- | --- | --- | --- | --- | --- |
| **Rack 21 (L21)** | Switch4 | **PC7** | L1 (Web) | **10** | 10.10.0.x | `10.10.0.2/24` |
|  |  | **PC8** | L2 (LAN) | **40** | 10.40.0.x | `10.40.0.2/24` |
| **Rack 22 (L22)** | Switch5 | **PC9** | L1 (App) | **20** | 10.20.0.x | `10.20.0.2/24` |
|  |  | **PC10** | L2 (LAN) | **40** | 10.40.0.x | `10.40.0.4/24` |
| **Rack 23 (L23)** | Switch6 | **PC11** | L1 (DB) | **30** | 10.30.0.x | `10.30.0.2/24` |
|  |  | **PC12** | L1 (Web) | **10** | 10.10.0.x | `10.10.0.4/24` |

---

### 3. O que tens de configurar agora

#### A. Nos Switches GNS3 (Switch1 a Switch6)

Tens de clicar com o botão direito em cada Switch -> **Configure** e definir as portas.
*Exemplo para o Switch1 (Rack 11):*

* **Port 0** (Ligada ao PC1): VLAN 10 (Access)
* **Port 1** (Ligada ao PC2): VLAN 40 (Access)
* **Port 2** (Ligada ao Leaf `eth1`): **Dot1q** (Trunk)

*(Repete a lógica para os outros switches conforme a tabela acima).*

#### B. Nos VPCS (Consola)

Configura apenas o IP e a máscara.

* **PC1:** `ip 10.10.0.1 255.255.255.0`
* **PC2:** `ip 10.40.0.1 255.255.255.0`
* ... e assim por diante.

#### C. Atualizar os Scripts dos Leafs (Importante!)

O script que tinhas para o **L11** (que criava VXLAN 10, 20, 30, 40) estava correto porque preparava o terreno para tudo.
Mas agora, para poupar recursos e ser mais rigoroso, podes (opcionalmente) ativar **apenas as VLANs necessárias em cada Leaf**.

* **No L11:** Precisa das pontes para VLAN 10 e 40.
* **No L12:** Precisa das pontes para VLAN 20 e 40.
* **No L13:** Precisa das pontes para VLAN 30 e 10.

*No entanto, se quiseres manter a simplicidade, **podes usar o script COMPLETO (com as 4 VLANs) em todos os Leafs**.* O único efeito secundário é teres interfaces criadas que não estão a ser usadas naquele momento, o que não faz mal nenhum e facilita a gestão (copias o mesmo ficheiro para todos).

**Recomendação:** Usa o script completo em todos os Leafs para não teres de criar 6 ficheiros diferentes. Assim, qualquer porta de qualquer switch pode ser configurada para qualquer VLAN e funcionar logo.
