Tens toda a razão! Foste muito perspicaz. Peço desculpa por essa omissão no passo anterior.

Como o **S1** (Lisboa) e o **S2** (Porto) são os "Route Reflectors" de cada Datacenter, eles precisam de falar um com o outro para trocarem as rotas dos seus respetivos Leafs. Sem isso, o L11 nunca vai saber onde está o L21.

Como confirmaste que o OSPF está a funcionar e os Spines se conseguem pingar (`10.0.0.11` <-> `10.0.0.12`), basta adicionar a configuração de BGP entre eles.

Aqui tens o que falta:

### 1. No Spine S1 (Lisboa)

Tens de adicionar o S2 (10.0.0.12) como vizinho iBGP.

```bash
vtysh
conf t
router bgp 22900
 ! Adicionar o vizinho S2
 neighbor 10.0.0.12 remote-as 22900
 neighbor 10.0.0.12 update-source lo
 !
 ! Ativar para EVPN
 address-family l2vpn evpn
  neighbor 10.0.0.12 activate
  ! Nota: Não precisa de ser route-reflector-client, basta ser vizinho normal
 exit-address-family
exit
write

```

### 2. No Spine S2 (Porto)

Tens de fazer o inverso, adicionar o S1 (10.0.0.11).

```bash
vtysh
conf t
router bgp 22900
 ! Adicionar o vizinho S1
 neighbor 10.0.0.11 remote-as 22900
 neighbor 10.0.0.11 update-source lo
 !
 ! Ativar para EVPN
 address-family l2vpn evpn
  neighbor 10.0.0.11 activate
 exit-address-family
exit
write

```

---

### Como Verificar se já funciona

1. **Estado do BGP:** No S1, faz `show bgp l2vpn evpn summary`. Agora deves ver os Leafs de Lisboa **E** o vizinho `10.0.0.12` (S2) com o estado estabelecido (números na coluna PfxRcd).
2. **Tabela de Rotas:** No L11 (Leaf de Lisboa), faz `show bgp l2vpn evpn route`.
* Procura por rotas "Type-2" (MAC/IP) ou "Type-3" (Inclusive Multicast) que venham do IP `10.0.0.21` (o Leaf do Porto).
* Se vires rotas que **não** são tuas (Next Hop = IP de um Leaf do Porto), então o túnel já deve funcionar.



Tenta o ping novamente entre os clientes (`ping 10.40.0.2` a partir do `10.40.0.1`) depois de configurares isto. Se funcionar, diz-me para avançarmos para a parte do MPLS-TE (Cliente L1)!
